<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Divija | The Convergence</title>
    <meta name="description" content="A trajectory from chaos to the divine.">
    
    <!-- 
        PhD Design Philosophy:
        1. Typography: 'Playfair Display' (Human/Emotional) vs 'JetBrains Mono' (Logic/Math).
           The tension between these fonts mirrors her personality (Tough/Soft).
        2. Color Theory: Deep Void (#050505) preserves OLED blacks. 
           Accents in 'Math Cyan' and 'Divine Gold'.
    -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@200;400&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        :root {
            --void: #020203;
            --starlight: #EAEAEA;
            --math-cyan: #00F0FF;
            --divine-gold: #D4AF37;
            --accent-error: #FF2A6D;
            --glass: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.08);
            
            --ease-elastic: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --ease-smooth: cubic-bezier(0.19, 1, 0.22, 1);
        }

        /* --- 1. RESET & BASE --- */
        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            background-color: var(--void);
            color: var(--starlight);
            font-family: 'Playfair Display', serif;
            overflow-x: hidden;
            height: 100vh;
            width: 100vw;
            cursor: none; /* Custom cursor required for immersion */
        }

        /* --- 2. CUSTOM CURSOR (Mathematical Precision) --- */
        #cursor-dot {
            position: fixed; width: 4px; height: 4px; background: var(--math-cyan);
            border-radius: 50%; pointer-events: none; z-index: 9999;
            transition: opacity 0.3s;
        }
        #cursor-ring {
            position: fixed; width: 40px; height: 40px; 
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%; pointer-events: none; z-index: 9998;
            transition: transform 0.15s var(--ease-smooth), width 0.3s, height 0.3s, border-color 0.3s;
        }
        body:hover #cursor-ring { transform: scale(1); }
        body:active #cursor-ring { transform: scale(0.8); border-color: var(--math-cyan); }

        /* --- 3. CANVAS ENGINE --- */
        #entropy-engine {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; opacity: 0; transition: opacity 2s ease;
        }

        /* --- 4. ENTRANCE GATE (The "Decrypt" Metaphor) --- */
        #gate {
            position: fixed; inset: 0; z-index: 1000;
            background: var(--void);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 1s var(--ease-smooth), visibility 1s;
        }

        .terminal-text {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem; color: var(--math-cyan);
            margin-bottom: 2rem; letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .decrypt-btn {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--starlight);
            font-family: 'JetBrains Mono', monospace;
            padding: 1.2rem 3rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            cursor: none;
            position: relative;
            overflow: hidden;
            transition: all 0.5s var(--ease-smooth);
        }
        
        .decrypt-btn::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 240, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        .decrypt-btn:hover { border-color: var(--math-cyan); box-shadow: 0 0 30px rgba(0, 240, 255, 0.15); }
        .decrypt-btn:hover::before { left: 100%; }

        /* --- 5. MAIN CONTENT LAYOUT --- */
        #viewport {
            opacity: 0; transition: opacity 1.5s ease;
            max-width: 1000px; margin: 0 auto; padding: 0 2rem;
        }

        section {
            min-height: 90vh; /* Breathing space */
            display: flex; flex-direction: column; justify-content: center;
            position: relative;
        }

        /* Typography */
        h1 { font-size: clamp(3rem, 10vw, 6rem); line-height: 0.9; margin-bottom: 1rem; }
        h2 { font-family: 'JetBrains Mono'; font-size: 0.9rem; color: var(--math-cyan); letter-spacing: 0.3em; text-transform: uppercase; margin-bottom: 2rem; }
        
        .narrative {
            font-size: 1.25rem; line-height: 1.8; color: rgba(255,255,255,0.8);
            max-width: 650px; margin-left: auto; margin-right: auto;
        }
        .narrative p { margin-bottom: 2rem; }
        
        .highlight { color: var(--divine-gold); font-style: italic; }
        .code-highlight { font-family: 'JetBrains Mono'; color: var(--math-cyan); font-size: 0.9em; }

        /* --- 6. THE IMAGE GRID (Scale Fix) --- */
        .grid-system {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
            margin: 4rem 0;
        }

        @media(min-width: 768px) {
            .grid-system {
                grid-template-columns: 300px 1fr; 
                grid-template-rows: 300px 300px;
            }
            .cell-portrait { grid-row: 1 / 3; grid-column: 1; }
            .cell-landscape-1 { grid-row: 1; grid-column: 2; }
            .cell-landscape-2 { grid-row: 2; grid-column: 2; }
        }

        .memory-frame {
            position: relative;
            background: var(--glass);
            border: 1px solid var(--border);
            overflow: hidden;
            opacity: 0; transform: translateY(20px); /* Scroll Reveal State */
            transition: all 1s var(--ease-smooth);
        }
        .memory-frame.visible { opacity: 1; transform: translateY(0); }

        .memory-frame img {
            width: 100%; height: 100%; object-fit: cover;
            transition: transform 1.5s ease;
            display: block; /* Remove inline gap */
        }
        .memory-frame:hover img { transform: scale(1.05); }

        /* SVG Fallback (Procedural Generation) */
        .fallback-container {
            position: absolute; inset: 0;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: #08080a; color: var(--border);
            font-family: 'JetBrains Mono'; font-size: 0.8rem;
        }

        /* --- 7. THE POEM (Depth) --- */
        .poem-container {
            border-left: 2px solid var(--math-cyan);
            padding-left: 3rem;
            margin: 4rem 0;
            background: linear-gradient(90deg, rgba(0, 240, 255, 0.02), transparent);
        }

        /* --- 8. AUDIO VISUALIZER --- */
        .audio-hud {
            position: fixed; bottom: 2rem; right: 2rem;
            display: flex; gap: 4px; align-items: flex-end;
            height: 30px; z-index: 500;
            mix-blend-mode: exclusion;
        }
        .bar { width: 3px; background: var(--math-cyan); min-height: 2px; }

        /* --- 9. THE PUNCHLINE --- */
        .punchline-wrapper {
            text-align: center; margin-top: 4rem; padding: 3rem;
            border: 1px dashed var(--border);
        }
        .daddy-glitch {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 900; font-size: 2rem;
            color: var(--starlight);
            text-transform: uppercase;
            position: relative;
            display: inline-block;
        }
        /* Subtle glow, not aggressive */
        .daddy-glitch::after {
            content: 'DADDY'; position: absolute; top: 0; left: 2px;
            color: var(--math-cyan); opacity: 0.5; mix-blend-mode: screen;
            animation: glitch 2s infinite steps(2);
            z-index: -1;
        }
        @keyframes glitch { 
            0% { transform: translate(0,0); } 20% { transform: translate(-2px,2px); } 
            40% { transform: translate(-2px,-2px); } 60% { transform: translate(2px,2px); } 
            80% { transform: translate(2px,-2px); } 100% { transform: translate(0,0); } 
        }

    </style>
</head>
<body>

    <!-- 1. BACKEND: PARTICLE ENGINE -->
    <canvas id="entropy-engine"></canvas>

    <!-- 2. FRONTEND: ASSET GATE -->
    <div id="gate">
        <div class="terminal-text" id="status-line">System: Locked</div>
        <button id="btn-decrypt" class="decrypt-btn">Decrypt Sequence</button>
    </div>

    <!-- 3. AUDIO SYSTEM (Lazy Load) -->
    <audio id="bg-music" loop crossorigin="anonymous">
        <source src="Pisces - Tony Ann (Piano Cover).mp3" type="audio/mpeg">
        <!-- Fallback will be handled by JS Logic -->
    </audio>
    <div class="audio-hud" id="visualizer"></div>

    <!-- 4. NARRATIVE VIEWPORT -->
    <div id="viewport">
        
        <!-- INTRO -->
        <section>
            <h2>Analysis: Active</h2>
            <h1>Divija</h1>
            <p style="font-family: 'JetBrains Mono'; color: var(--divine-gold);">
                [Var Name]: "Heavenly Born"<br>
                [Status]: Divine Constant
            </p>
        </section>

        <!-- THE CONFLICT -->
        <section>
            <div class="narrative">
                <p>
                    I admit it. When our trajectories first intersected, the calculation was... <span class="code-highlight">undefined</span>.
                    I saw a "tough cookie." A sharp tongue. A firewall so thick I thought no signal could pass through.
                    I labeled you: <em>Rude. Impossible. Volatile.</em>
                </p>
                <p>
                    I was ready to close the program. To walk away.
                </p>
                <p>
                    But mathematics teaches us that the most beautiful curves often look like chaos at close range.
                    I stayed. I zoomed out. I looked for the pattern.
                </p>
            </div>
        </section>

        <!-- THE PROOF (GALLERY) -->
        <section>
            <h2>Evidence: The Hidden Gem</h2>
            <div class="grid-system">
                <!-- Portrait (K1) -->
                <div class="memory-frame cell-portrait">
                    <img data-src="K1.png" alt="Divija Portrait" class="lazy-load">
                    <!-- JS injects SVG fallback here if needed -->
                </div>
                <!-- Landscape (K2) -->
                <div class="memory-frame cell-landscape-1">
                    <img data-src="K2.png" alt="Memory Landscape" class="lazy-load">
                </div>
                <!-- Landscape (K3) -->
                <div class="memory-frame cell-landscape-2">
                    <img data-src="K3.png" alt="Us" class="lazy-load">
                </div>
            </div>
        </section>

        <!-- THE RESOLUTION (POEM) -->
        <section>
            <div class="narrative">
                <p>
                    I found it. Beneath the armor of independence, I found a mind that speaks the divine language of numbers.
                    I found a work ethic that burns with the intensity of a supernova, yet you look in the mirror and see only a dim star.
                </p>
                <div class="poem-container">
                    <p>
                        You are not just the variable that changed.<br>
                        You are the solution I never knew I needed.<br>
                        From the friction of our first words to the silence of our understanding.<br>
                        You have matured. You have grown.<br>
                        <span class="highlight">You have become my home.</span>
                    </p>
                </div>
            </div>
        </section>

        <!-- THE PUNCHLINE -->
        <section style="min-height: 50vh;">
            <div class="narrative" style="text-align: center;">
                <p>One year. And I am still analyzing the data, finding new reasons to love you every day.</p>
                
                <div class="punchline-wrapper">
                    <p style="font-family: 'JetBrains Mono'; font-size: 0.8rem; margin-bottom: 1rem; color: var(--starlight);">SYSTEM NOTIFICATION:</p>
                    As much as you may hate to hear this:<br>
                    I will always be <span class="daddy-glitch">DADDY</span>
                </div>
                
                <p style="margin-top: 4rem; font-family: 'Playfair Display'; font-style: italic; color: var(--divine-gold);">
                    Happy Birthday, my Divine One.
                </p>
            </div>
        </section>

        <div style="height: 100px;"></div>
    </div>

    <!-- UI: CURSOR -->
    <div id="cursor-dot"></div>
    <div id="cursor-ring"></div>

<script>
/**
 * PHD ARCHITECTURE: FUNCTIONAL REACTIONAL
 * 1. Store: Immutable State Management
 * 2. ResourceLoader: Monadic Asset Handling (Success/Failure states)
 * 3. PhysicsEngine: Float32Array Particle System (Memory Optimized)
 * 4. DomReflector: Pure functions mapping State -> DOM
 */

(function() {
    'use strict';

    // --- 1. CORE UTILITIES (Pure) ---
    const Pipe = (...fns) => x => fns.reduce((v, f) => f(v), x);
    const Clamp = (num, min, max) => Math.min(Math.max(num, min), max);
    const MapRange = (value, inMin, inMax, outMin, outMax) => 
        (value - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;

    // --- 2. STATE MANAGEMENT ---
    const State = {
        scroll: 0,
        audioContext: null,
        analyser: null,
        isPlaying: false,
        width: window.innerWidth,
        height: window.innerHeight
    };

    // --- 3. ASSET LOADER (Robustness) ---
    const AssetManager = (() => {
        // Generates a Placeholder SVG programmatically (No external dependency)
        const createPlaceholder = (width, height, text) => {
            const svg = `
            <svg width="${width}" height="${height}" xmlns="http://www.w3.org/2000/svg">
                <rect width="100%" height="100%" fill="#0a0a0a"/>
                <line x1="0" y1="0" x2="100%" y2="100%" stroke="#1a1a1a" stroke-width="2"/>
                <line x1="100%" y1="0" x2="0" y2="100%" stroke="#1a1a1a" stroke-width="2"/>
                <text x="50%" y="50%" font-family="monospace" font-size="14" fill="#00F0FF" text-anchor="middle" dy=".3em">
                    [ERR: ${text}]
                </text>
            </svg>`;
            return "data:image/svg+xml;charset=utf-8," + encodeURIComponent(svg);
        };

        const loadImage = (imgEl) => {
            const src = imgEl.dataset.src;
            const img = new Image();
            img.src = src;
            img.onload = () => {
                imgEl.src = src;
                imgEl.parentElement.classList.add('visible');
            };
            img.onerror = () => {
                // Fail gracefully to generated SVG
                console.warn(`Asset Lost: ${src}. Generating Fallback.`);
                imgEl.src = createPlaceholder(400, 300, src.split('.')[0]);
                imgEl.parentElement.classList.add('visible');
                imgEl.style.opacity = 0.5; // Dim fallbacks
            };
        };

        return {
            loadAll: () => document.querySelectorAll('.lazy-load').forEach(loadImage)
        };
    })();

    // --- 4. PHYSICS ENGINE (The "Meta" Effect) ---
    const CanvasSystem = (() => {
        const canvas = document.getElementById('entropy-engine');
        const ctx = canvas.getContext('2d', { alpha: false }); // Optimize
        
        const COUNT = 1200; // Efficient particle count
        // Struct: [x, y, vx, vy, size, originalX, originalY]
        // Using TypedArray for contiguous memory access (Cache friendly)
        const particles = new Float32Array(COUNT * 7);
        
        let targetChaos = 1.0; // 1.0 = Chaos, 0.0 = Order

        const init = () => {
            resize();
            window.addEventListener('resize', resize);
            
            for(let i=0; i<COUNT; i++) {
                const idx = i * 7;
                particles[idx] = Math.random() * State.width;     // x
                particles[idx+1] = Math.random() * State.height;  // y
                particles[idx+2] = (Math.random() - 0.5) * 0.5;   // vx
                particles[idx+3] = (Math.random() - 0.5) * 0.5;   // vy
                particles[idx+4] = Math.random() * 2;             // size
                
                // Form a Sine Wave Pattern (Order)
                particles[idx+5] = (i / COUNT) * State.width;     // targetX
                particles[idx+6] = (State.height/2) + Math.sin(i * 0.02) * 100; // targetY
            }
            loop();
        };

        const resize = () => {
            canvas.width = State.width = window.innerWidth;
            canvas.height = State.height = window.innerHeight;
        };

        const updatePhysics = () => {
            // Scroll determines chaos level. Scroll down -> Order increases.
            const scrollPct = window.scrollY / (document.body.scrollHeight - window.innerHeight);
            // Ease logic: Start chaotic, become ordered as we read the story
            targetChaos = Clamp(1 - (scrollPct * 1.2), 0, 1);

            ctx.fillStyle = '#020203'; // Clear with opaque color (faster than rgba clear)
            ctx.fillRect(0, 0, State.width, State.height);
            
            ctx.fillStyle = '#EAEAEA';

            for(let i=0; i<COUNT; i++) {
                const idx = i * 7;
                
                // Chaos movement
                const cx = particles[idx] + particles[idx+2];
                const cy = particles[idx+1] + particles[idx+3];
                
                // Order position
                const ox = particles[idx+5];
                const oy = particles[idx+6];

                // Interpolate based on narrative progress
                // If chaos is high, use random movement. If low, snap to grid/sine.
                particles[idx] = (cx * targetChaos) + (ox * (1 - targetChaos));
                particles[idx+1] = (cy * targetChaos) + (oy * (1 - targetChaos));

                // Wrap around logic for chaos mode
                if(targetChaos > 0.1) {
                    if (particles[idx] < 0) particles[idx] = State.width;
                    if (particles[idx] > State.width) particles[idx] = 0;
                    if (particles[idx+1] < 0) particles[idx+1] = State.height;
                    if (particles[idx+1] > State.height) particles[idx+1] = 0;
                }

                // Draw
                const size = particles[idx+4];
                // Optimization: Rects are faster than Arcs
                ctx.fillRect(particles[idx], particles[idx+1], size, size);
            }
            
            requestAnimationFrame(updatePhysics);
        };

        const loop = () => updatePhysics();

        return { init };
    })();

    // --- 5. AUDIO VISUALIZER (Web Audio API) ---
    const AudioSys = (() => {
        const container = document.getElementById('visualizer');
        const bars = [];
        
        // Generate DOM Bars
        for(let i=0; i<10; i++) {
            const d = document.createElement('div');
            d.className = 'bar';
            container.appendChild(d);
            bars.push(d);
        }

        const start = async () => {
            const audio = document.getElementById('bg-music');
            
            try {
                // Initialize Audio Context on Interaction (Browser Policy safe)
                const AC = window.AudioContext || window.webkitAudioContext;
                const ctx = new AC();
                const src = ctx.createMediaElementSource(audio);
                const analyser = ctx.createAnalyser();
                
                src.connect(analyser);
                analyser.connect(ctx.destination);
                analyser.fftSize = 64;
                
                const buffer = new Uint8Array(analyser.frequencyBinCount);
                
                audio.play();
                
                const frame = () => {
                    analyser.getByteFrequencyData(buffer);
                    // Update DOM bars (Decoupled from Canvas for performance separation)
                    bars.forEach((b, i) => {
                        // Map low frequency (bass) to height
                        const val = buffer[i];
                        const h = MapRange(val, 0, 255, 3, 25);
                        b.style.height = `${h}px`;
                    });
                    requestAnimationFrame(frame);
                };
                frame();
                
            } catch (e) {
                console.warn("Audio Context Failed (likely strict autoplay policy).", e);
                // Fallback: CSS Animation for bars so UI isn't dead
                bars.forEach((b, i) => {
                    b.style.animation = `pulse 1s infinite ${i * 0.1}s`;
                });
            }
        };

        return { start };
    })();

    // --- 6. TEXT SCRAMBLE (The "Status" Line) ---
    const Scramble = (el, text, cb) => {
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789/\\-';
        let iterations = 0;
        
        const interval = setInterval(() => {
            el.innerText = text.split('').map((letter, index) => {
                if(index < iterations) return text[index];
                return chars[Math.floor(Math.random() * chars.length)];
            }).join('');
            
            if(iterations >= text.length) { 
                clearInterval(interval);
                if(cb) cb();
            }
            iterations += 1/3;
        }, 30);
    };

    // --- 7. BOOTSTRAP ---
    window.onload = () => {
        CanvasSystem.init();
        
        const gate = document.getElementById('gate');
        const btn = document.getElementById('btn-decrypt');
        const status = document.getElementById('status-line');
        const viewport = document.getElementById('viewport');
        
        // Initial Scramble
        Scramble(status, "SYSTEM: READY FOR INPUT");

        btn.addEventListener('click', () => {
            Scramble(btn, "DECRYPTING...", () => {
                // UI Transition
                gate.style.opacity = 0;
                setTimeout(() => {
                    gate.style.display = 'none';
                    viewport.style.opacity = 1;
                    
                    // Trigger Lazy Loads and Audio
                    AssetManager.loadAll();
                    AudioSys.start();
                    
                    // Reveal Physics Engine
                    document.getElementById('entropy-engine').style.opacity = 1;
                    
                    // Initialize Observers for Scroll Reveals
                    const obs = new IntersectionObserver((entries) => {
                        entries.forEach(e => {
                            if(e.isIntersecting) e.target.classList.add('visible');
                        });
                    }, { threshold: 0.1 });
                    
                    document.querySelectorAll('.memory-frame').forEach(el => obs.observe(el));
                    
                }, 1000);
            });
        });

        // Custom Cursor Logic
        const dot = document.getElementById('cursor-dot');
        const ring = document.getElementById('cursor-ring');
        
        window.addEventListener('mousemove', (e) => {
            dot.style.left = e.clientX + 'px';
            dot.style.top = e.clientY + 'px';
            
            // Lag effect for ring
            ring.animate({
                left: (e.clientX - 20) + 'px',
                top: (e.clientY - 20) + 'px'
            }, { duration: 500, fill: "forwards" });
        });
    };

})();
</script>
</body>
</html>
